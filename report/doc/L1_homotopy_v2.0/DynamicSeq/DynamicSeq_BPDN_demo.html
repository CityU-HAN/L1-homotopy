<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of DynamicSeq_BPDN_demo</title>
  <meta name="keywords" content="DynamicSeq_BPDN_demo">
  <meta name="description" content="BPDN update with sequential measurements homotopy comparison">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html L1_homotopy_v2.0 --><!-- menu.html DynamicSeq -->
<h1>DynamicSeq_BPDN_demo
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>BPDN update with sequential measurements homotopy comparison</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> BPDN update with sequential measurements homotopy comparison
 Author: Salman Asif
 Created: February 2009:

-------------------------------------------+
 Copyright (c) 2009.  Muhammad Salman Asif 
-------------------------------------------+</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="DynamicSeq_BPDN_function.html" class="code" title="function [xp_h, gamma_xh, iter, th] = DynamicSeq_BPDN_function(A, b, AtAgx, iAtAgx, y, w, xp, gamma_x, pk, tau, chk_e0, maxiter)">DynamicSeq_BPDN_function</a>	DynamicLasso_update_function.m</li><li><a href="../../L1_homotopy_v2.0/Pursuits_Homotopy/BPDN_homotopy_function.html" class="code" title="function out = BPDN_homotopy_function(A, y, in)">BPDN_homotopy_function</a>	BPDN_homotopy_function.m</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% BPDN update with sequential measurements homotopy comparison</span>
0002 <span class="comment">% Author: Salman Asif</span>
0003 <span class="comment">% Created: February 2009:</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%-------------------------------------------+</span>
0006 <span class="comment">% Copyright (c) 2009.  Muhammad Salman Asif</span>
0007 <span class="comment">%-------------------------------------------+</span>
0008 
0009 clear; clc
0010 
0011 <span class="comment">% load fixed random states</span>
0012 load RandomStates
0013 randn(<span class="string">'state'</span>,s_randn);
0014 rand(<span class="string">'state'</span>,s_rand);
0015 
0016 <span class="comment">% signal length</span>
0017 N = 256;
0018 <span class="comment">% number of spikes to put down</span>
0019 T = 30;
0020 <span class="comment">% number of observations to make</span>
0021 K = 100;
0022 
0023 <span class="comment">% random +/- 1 signal</span>
0024 x = zeros(N,1);
0025 q = randperm(N);
0026 x(q(1:T)) = randn(T,1);<span class="comment">%sign(randn(T,1)).*randint(T,1,256);</span>
0027 
0028 <span class="comment">% measurement matrix</span>
0029 G = randn(K,N)/sqrt(K);
0030 <span class="comment">% G = orth(G')';</span>
0031 A = G; <span class="comment">%(1:end-1,:);</span>
0032 <span class="comment">% b = G(end,:);</span>
0033 
0034 <span class="comment">% observations</span>
0035 sigma = .01;
0036 e = randn(K,1)*sigma;
0037 y = A*x + e;
0038 
0039 <span class="comment">% regularization parameter</span>
0040 tau = 0.005*max(abs(A'*y)); <span class="comment">%l1_ls</span>
0041 <span class="keyword">if</span> sigma&gt;0
0042     tau = sigma * sqrt(log(N)*2); <span class="comment">% BPDN</span>
0043     <span class="comment">%tau = max(abs(A'*(A*x-y))); % ideal ???</span>
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% Initial update using Lasso</span>
0047 [xp, gamma_x, xp_iter, t1] = <a href="../../L1_homotopy_v2.0/Pursuits_Homotopy/BPDN_homotopy_function.html" class="code" title="function out = BPDN_homotopy_function(A, y, in)">BPDN_homotopy_function</a>(A, y, tau,4*N); <span class="comment">%Lasso</span>
0048 
0049 chk_e0 = 1;  <span class="comment">% 0 or 1: This selects if we want to take U = (A'A+b'b) (1) or (A'A+e0*b'b) (0)...!</span>
0050 <span class="comment">% In simulation U = (A'A+b'b) works better</span>
0051 
0052 b = randn(1,N);
0053 ew = randn(1,1)*sigma;
0054 w = b*x+ew;
0055 
0056 <span class="comment">% Gram matrix update</span>
0057 AtAgx = A(:,gamma_x)'*A(:,gamma_x)+chk_e0*b(:,gamma_x)'*b(:,gamma_x);
0058 iAtAgx = inv(AtAgx);
0059 pk = A'*(A*xp-y);
0060 
0061 [xp_h, gamma_xh, xp_h_iter, th] =  <a href="DynamicSeq_BPDN_function.html" class="code" title="function [xp_h, gamma_xh, iter, th] = DynamicSeq_BPDN_function(A, b, AtAgx, iAtAgx, y, w, xp, gamma_x, pk, tau, chk_e0, maxiter)">DynamicSeq_BPDN_function</a>(A, b, AtAgx, iAtAgx, y, w, xp, gamma_x, pk, tau, chk_e0, 4*N);
0062 
0063 
0064 y2 = [y; w];
0065 G = [A; b];
0066 [xp2, gamma_x2, xp2_iter, t2] = <a href="../../L1_homotopy_v2.0/Pursuits_Homotopy/BPDN_homotopy_function.html" class="code" title="function out = BPDN_homotopy_function(A, y, in)">BPDN_homotopy_function</a>(G, y2, tau, 4*N); <span class="comment">%Lasso</span>
0067 
0068 <span class="comment">% [old_homotopy new_homotopy update_homotopy]</span>
0069 disp(<span class="string">' '</span>);
0070 disp(<span class="string">'Results for '</span>);
0071 disp(<span class="string">'old_homotopy , new_homotopy , update_homotopy'</span>)
0072 cputime_comparison = [t1 t2 th]
0073 Iter_comparison = [xp_iter xp2_iter xp_h_iter]
0074 
0075 <span class="comment">% figure(2); plot(xp_h-xp2); shg</span></pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>