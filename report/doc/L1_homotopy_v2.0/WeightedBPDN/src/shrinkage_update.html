<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of shrinkage_update</title>
  <meta name="keywords" content="shrinkage_update">
  <meta name="description" content="% Shrinkage parameters selection">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html L1_homotopy_v2.0 --><!-- ../menu.html WeightedBPDN --><!-- menu.html src -->
<h1>shrinkage_update
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>% Shrinkage parameters selection</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Shrinkage parameters selection
 Selects target weights for the next homotopy step such that the weights
 shrink at a faster rate on the active set than the inactive set.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="weight_param.html" class="code" title="function [alpha beta epsilon] = weight_param(rwt_mode,itr,varargin)">weight_param</a>	Compute alpha,beta, and epsilon to update weights as</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="wtBPDN_adaptive_function.html" class="code" title="function out = wtBPDN_adaptive_function(A, y, in)">wtBPDN_adaptive_function</a>	wtBPDN_adaptive_function</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Shrinkage parameters selection</span>
0002 <span class="comment">% Selects target weights for the next homotopy step such that the weights</span>
0003 <span class="comment">% shrink at a faster rate on the active set than the inactive set.</span>
0004 
0005 <span class="keyword">switch</span> shrinkage_mode
0006     <span class="keyword">case</span> <span class="string">'Tsteps'</span>       
0007         <span class="comment">% active weights are reduced to tau/ewt</span>
0008         tau_vec = ones(N,1)*tau;
0009         tau_vec(gamma_xh) = tau/ewt;
0010     <span class="keyword">case</span> <span class="string">'frac'</span>
0011         <span class="comment">% acitve weights are reduced to a fraction of their present value</span>
0012         tau_vec = ones(N,1)*min(epsilon/ewt,max(epsilon_vec));
0013         tau_vec(gamma_xh) = epsilon_vec(gamma_xh)/ewt;
0014     <span class="keyword">case</span> <span class="string">'Trwt'</span>
0015         <span class="comment">% active weights are modified based on current signal estimate</span>
0016         [alpha beta epsilon] = <a href="weight_param.html" class="code" title="function [alpha beta epsilon] = weight_param(rwt_mode,itr,varargin)">weight_param</a>(5,1,xk_1,M);    
0017         ewt_b = beta; <span class="comment">% M*(norm(xk_1,2)/norm(xk_1,1))^2;</span>
0018         tau_vec = ones(N,1)*tau;
0019         <span class="comment">% tau_vec(gamma_xh) = min([tau_vec(gamma_xh) tau./abs(xk_1(gamma_xh))/ewt_b],[],2);</span>
0020         tau_vec(gamma_xh) = min([tau_vec(gamma_xh) tau./(beta*abs(xk_1(gamma_xh))+epsilon)],[],2);
0021         <span class="comment">% alpha = 0.75;</span>
0022         <span class="comment">% tau_vec = alpha*tau_vec+(1-alpha)*epsilon_vec;</span>
0023     <span class="keyword">case</span> <span class="string">'rwt'</span>
0024         <span class="comment">% hybrid scheme...</span>
0025         <span class="comment">%  first stage: reduce active weights by a fraction to same values</span>
0026         <span class="comment">%  second stage: reduce active weights according to signal estimate</span>
0027         <span class="comment">%</span>
0028         
0029         <span class="comment">% this two-step procedure is often slower, but more stable, than Trwt</span>
0030         <span class="keyword">if</span> epsilon &lt;= tau*ewt;
0031             rwt_step2 = 1;
0032         <span class="keyword">end</span>
0033         <span class="keyword">if</span> rwt_step2
0034             [alpha beta epsilon] = <a href="weight_param.html" class="code" title="function [alpha beta epsilon] = weight_param(rwt_mode,itr,varargin)">weight_param</a>(5,1,xk_1,M);    
0035             ewt_b = beta; <span class="comment">% M*(norm(xk_1,2)/norm(xk_1,1))^2;</span>
0036             
0037             tau_vec = ones(N,1)*tau;
0038             <span class="comment">% tau_vec(gamma_xh) = min([tau_vec(gamma_xh) norm(xk_1,2)/sqrt(N*M)*tau./abs(xk_1(gamma_xh)*ewt)],[],2);</span>
0039             <span class="comment">% how about the following selection for which w_i = \tau/beta, where beta = sqrt(M)/\|x\|_1*\|x\|_2 which implies that sqrt(M)&gt; beta &gt; sqrt(M/K)</span>
0040             <span class="comment">% tau_vec(gamma_xh) = min([tau_vec(gamma_xh) norm(xk_1,1)/M*tau./abs(xk_1(gamma_xh)*ewt)],[],2);</span>
0041             <span class="comment">% tau_vec(gamma_xh) = min([tau_vec(gamma_xh) (norm(xk_1,1)/norm(xk_1,2)/sqrt(M))^1*tau./abs(xk_1(gamma_xh)*ewt)],[],2);</span>
0042             tau_vec(gamma_xh) = min([tau_vec(gamma_xh) tau./abs(xk_1(gamma_xh))/ewt_b],[],2);
0043         <span class="keyword">else</span>            
0044             tau_vec = ones(N,1)*min(epsilon/ewt,max(epsilon_vec));
0045             <span class="comment">% tau_vec(gamma_xh) = ones(length(gamma_xh),1)*epsilon_old;</span>
0046             tau_vec(gamma_xh) = min([epsilon_vec(gamma_xh) epsilon/ewt*ones(length(gamma_xh),1)],[],2);
0047             <span class="comment">% tau_vec(gamma_xh) = epsilon/ewt*ones(length(gamma_xh),1);</span>
0048         <span class="keyword">end</span>
0049     <span class="keyword">case</span> <span class="string">'OLS'</span>
0050         <span class="comment">% set according to LS solution on the active support</span>
0051         <span class="comment">%   such as w_gamma = 1./abs((A_gamma'*A_gamma)^-1*A_gamma'*y);</span>
0052         <span class="comment">% xols = (A_gamma'*A_gamma)^-1*A_gamma'*y;</span>
0053         xols = zeros(N,1);
0054         <span class="comment">%         switch delx_mode</span>
0055         <span class="comment">%             case 'mil'</span>
0056         <span class="comment">%                 xols(gamma_xh) = iAtA*(A(:,gamma_xh)'*y);</span>
0057         <span class="comment">%             case 'qr'</span>
0058         <span class="comment">%                 xols(gamma_xh) = R\(R'\(A(:,gamma_xh)'*y));</span>
0059         <span class="comment">%         end</span>
0060         xols(gamma_xh) = A(:,gamma_xh)\y;
0061         [alpha beta epsilon] = <a href="weight_param.html" class="code" title="function [alpha beta epsilon] = weight_param(rwt_mode,itr,varargin)">weight_param</a>(5,1,xols,M);   
0062         <span class="comment">% alpha =1; epsilon = 1; beta = M*(norm(xk_1,2)/norm(xk_1,1))^2;</span>
0063         tau_vec = ones(N,1)*tau;
0064         <span class="comment">% tau_vec(gamma_xh) = min([tau_vec(gamma_xh) tau./(beta*abs(xols(gamma_xh))+epsilon)],[],2);</span>
0065         tau_vec(gamma_xh) = max([tau_vec(gamma_xh)./(beta*abs(xols(gamma_xh))+epsilon) epsilon_vec(gamma_xh)./(beta*abs(xols(gamma_xh))+epsilon)],[],2);
0066         figure(107); plot([x_orig xols xk_1]); pause(1/60);
0067 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>