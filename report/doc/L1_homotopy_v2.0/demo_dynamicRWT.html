<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of demo_dynamicRWT</title>
  <meta name="keywords" content="demo_dynamicRWT">
  <meta name="description" content="demo_dynamicRWT">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html L1_homotopy_v2.0 -->
<h1>demo_dynamicRWT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>demo_dynamicRWT</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> demo_dynamicRWT

 Solves the following dynamic BPDN problem
 min_x  \|Wx\|_1 + 1/2*||y-Ax||_2^2  

 which updates W and the solution as the signal changes 

   
 Applications:
       tracking where y, A, and x, are updated..
       predict an estimate of the solution and
       update weights according to the predicted solution

 We can also add a difference operator ||x-xh||_2^2 in the reconstruction

 Written by: Salman Asif, Georgia Tech
 Email: sasif@gatech.edu
 Created: August 2012</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="l1homotopy.html" class="code" title="function out = l1homotopy(A, y, opts)">l1homotopy</a>	l1homotopy.m</li><li><a href="../L1_homotopy_v2.0/solvers/SpaRSA_adpW.html" class="code" title="function [x,x_debias,objective,times,debias_start,mses,taus, numA, numAt]=SpaRSA_adpW(y,A,tau,varargin)">SpaRSA_adpW</a>	SpaRSA version 2.0, December 31, 2007</li><li><a href="../L1_homotopy_v2.0/solvers/soft.html" class="code" title="function y = soft(x,T)">soft</a>	</li><li><a href="../L1_homotopy_v2.0/utils/genAmat.html" class="code" title="function A = genAmat(M,N,in);">genAmat</a>	</li><li><a href="../L1_homotopy_v2.0/utils/genSignal.html" class="code" title="function [x varargout] = genSignal(N,in)">genSignal</a>	Inputs</li><li><a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>	cshift.m</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% demo_dynamicRWT</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Solves the following dynamic BPDN problem</span>
0004 <span class="comment">% min_x  \|Wx\|_1 + 1/2*||y-Ax||_2^2</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% which updates W and the solution as the signal changes</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Applications:</span>
0010 <span class="comment">%       tracking where y, A, and x, are updated..</span>
0011 <span class="comment">%       predict an estimate of the solution and</span>
0012 <span class="comment">%       update weights according to the predicted solution</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% We can also add a difference operator ||x-xh||_2^2 in the reconstruction</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Written by: Salman Asif, Georgia Tech</span>
0017 <span class="comment">% Email: sasif@gatech.edu</span>
0018 <span class="comment">% Created: August 2012</span>
0019 
0020 clear
0021 close all force
0022  
0023 <span class="comment">%% Setup path</span>
0024 mname = mfilename;
0025 mpath = mfilename(<span class="string">'fullpath'</span>);
0026 mdir = mpath(1:end-length(mname));
0027 cd(mdir);
0028 
0029 addpath utils/ 
0030 addpath utils/utils_wavelet/
0031 addpath solvers/
0032 <span class="comment">% addpath WeightedBPDN/src/</span>
0033 
0034 disp([<span class="string">'--------------------'</span>,datestr(now),<span class="string">'-------------------------'</span>])
0035 
0036 <span class="comment">% load RandomStates</span>
0037 <span class="comment">%</span>
0038 rseed = 2012;
0039 rand(<span class="string">'state'</span>,rseed);
0040 randn(<span class="string">'state'</span>,rseed);
0041 
0042 <span class="comment">% simulation parameters</span>
0043 mType = <span class="string">'randn'</span>; <span class="comment">% {'randn','orth','rdct'};</span>
0044 sType = <span class="string">'pcwpoly'</span>; <span class="comment">% {'randn','sign','highD', 'blocks','pcwPoly'}</span>
0045 SNR = 40;       <span class="comment">% additive Gaussian noise</span>
0046 
0047 N = 256;   <span class="comment">% signal length</span>
0048 M = round(N/4);    <span class="comment">% no. of measurements</span>
0049 T = round(M/3);    <span class="comment">% sparsity level</span>
0050 
0051 <span class="comment">% signal dynamics</span>
0052 <a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a> = -2;
0053 rshift_h = @(z) (rand-0.5)/20;
0054 
0055 <span class="comment">% reg. parameter for temporal difference..</span>
0056 lambda_diff = sqrt(1);
0057 
0058 <span class="comment">% rank-1 update mode</span>
0059 delx_mode = <span class="string">'mil'</span>; <span class="comment">% mil or qr</span>
0060 lambda = 0;
0061 fprintf(<span class="string">'Tracking a dynamical signal using reweighting..\n'</span>);
0062 str0 = sprintf(<span class="string">'mType-%s, sType-%s, SNR = %d, (N,M,T) = %d, %d, %d.'</span>, mType, sType, SNR, N, M, T);
0063 disp(str0);
0064  
0065 maxsim = 200;
0066 SIM_stack = cell(maxsim,1);
0067 SIM_memory = cell(maxsim,1);
0068 
0069 x_vec = zeros(N*maxsim,1);
0070 xh_vec = zeros(N*maxsim,1);
0071 
0072 <span class="comment">%% Setup signal and system</span>
0073 
0074 <span class="comment">% Generate a random signal</span>
0075 in = []; in.type = sType; in.T = T; in.randgen = 0; in.wType = <span class="string">'daub79'</span>; in.take_fwt = 1;
0076 [x sig wave_struct] = <a href="../L1_homotopy_v2.0/utils/genSignal.html" class="code" title="function [x varargout] = genSignal(N,in)">genSignal</a>(N,in);
0077 [val ind] = sort(abs(x),<span class="string">'descend'</span>);
0078 ind_pos = ind(val&gt;1e-1);
0079 gamma_orig = ind_pos(1:min(length(ind_pos),M-1));
0080 
0081 <span class="comment">% Setup dynamical model</span>
0082 x_orig = x; <span class="comment">% Initial signal</span>
0083 
0084 <span class="comment">% At every time instance, add to the original/previous signal</span>
0085 <span class="comment">% an integer circular shift that is known</span>
0086 <span class="comment">% a random drift that is unknown</span>
0087 <span class="keyword">if</span> isempty(wave_struct)
0088     <span class="comment">% cshfits</span>
0089     F_h = @(x,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>,rshift) interp1(1:N,circshift(x,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>),[1:N]+rshift,<span class="string">'linear'</span>,<span class="string">'extrap'</span>)';
0090     W_h = @(z) z; iW_h = @(z) z; 
0091 <span class="keyword">else</span>
0092       
0093     W_h = wave_struct.W_h;
0094     iW_h = wave_struct.iW_h;    
0095     
0096     F_h = @(x,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>,rshift) W_h(interp1(1:N,circshift(iW_h(x),<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>),[1:N]+rshift,<span class="string">'linear'</span>,<span class="string">'extrap'</span>)');
0097 <span class="keyword">end</span>
0098 
0099 <span class="comment">% measurement matrix</span>
0100 in = []; in.type = mType;
0101 A = <a href="../L1_homotopy_v2.0/utils/genAmat.html" class="code" title="function A = genAmat(M,N,in);">genAmat</a>(M,N,in);
0102 
0103 <span class="comment">% measurements</span>
0104 sigma = sqrt(norm(A*x)^2/10^(SNR/10)/M);
0105 e = randn(M,1)*sigma;
0106 y = A*x+e;
0107 
0108 <span class="comment">%     % orthogonalize rows of A</span>
0109 <span class="comment">%     [Q, R] = qr(A',0);</span>
0110 <span class="comment">%     A = Q'; y = R' \ y;</span>
0111 
0112 <span class="comment">% parameter selection</span>
0113 <span class="comment">% tau = sigma*sqrt(log(N));</span>
0114 tau = max(1e-4*max(abs(A'*y)),sigma*sqrt(log(N)));
0115 
0116 maxiter = 4*N;
0117 err_fun = @(z) (norm(x-z)/norm(x))^2;
0118 
0119 <span class="comment">%% initialize...!</span>
0120 <span class="comment">%</span>
0121 <span class="comment">% Assume a previous signal is known..</span>
0122 <span class="comment">% [val_sort ind_sort] = sort(abs(x),'descend');</span>
0123 <span class="comment">% xh_old = x;</span>
0124 <span class="comment">% xh_old(ind_sort(M+1:end)) = 0;</span>
0125 <span class="comment">%</span>
0126 <span class="comment">% lambda_diff = sqrt(1e-0);</span>
0127 <span class="comment">%</span>
0128 <span class="comment">% A = [A; lambda_diff*eye(N)];</span>
0129 <span class="comment">% y = [A(1:M,:)*x+e; lambda_diff*xh_old];</span>
0130 
0131 
0132 <span class="comment">% rwt L1 using l1homotopy</span>
0133 in = [];
0134 in.tau = tau; W = tau;
0135 in.delx_mode = delx_mode;
0136 in.debias = 0;
0137 in.verbose = 0;
0138 in.plots = 0;
0139 in.record = 1;
0140 in.err_fun = err_fun;
0141 tic 
0142 <span class="keyword">for</span> wt_itr = 1:5 
0143     
0144     W_old = W;
0145     
0146     out = <a href="l1homotopy.html" class="code" title="function out = l1homotopy(A, y, opts)">l1homotopy</a>(A,y,in);
0147     xh = out.x_out;
0148     iter_bpdn = out.iter;
0149     time_bpdn = toc;
0150     gamma_bpdn = out.gamma;
0151     err_bpdn = out.error_table;
0152     
0153     <span class="comment">% Update weights</span>
0154     xh_old = xh;
0155     
0156     alpha = 1; epsilon = 1;
0157     beta = M*(norm(xh_old,2)/norm(xh_old,1))^2;
0158     W = tau/alpha./(beta*abs(xh_old)+epsilon);
0159     
0160     <span class="comment">% yh = A*xh_old;</span>
0161     <span class="comment">% u = -sign(xh_old).*W_old; % out.pk;</span>
0162     <span class="comment">% Atdyu = A'*(yh-y)-u;</span>
0163     
0164     yh = A*xh_old;
0165     Atr = A'*(A*xh_old-y);
0166     u =  -W.*sign(xh_old)-Atr;
0167     pk_old = Atr+u;
0168     
0169     in = out;
0170     in.xh_old = xh_old;
0171     in.pk_old = pk_old;
0172     in.u = u;
0173     in.W_old = W_old;
0174     in.W = W;
0175     <span class="comment">% in.Atdyu = Atdyu;</span>
0176 <span class="keyword">end</span>
0177 W = W_old;
0178  
0179 
0180 <span class="comment">% in = [];</span>
0181 <span class="comment">% in.tau = tau;</span>
0182 <span class="comment">% in.delx_mode = delx_mode;</span>
0183 <span class="comment">% in.debias = 0;</span>
0184 <span class="comment">% in.verbose = 0;</span>
0185 <span class="comment">% in.plots = 0;</span>
0186 <span class="comment">% in.record = 1;</span>
0187 <span class="comment">% in.err_fun = err_fun;</span>
0188 <span class="comment">% tic</span>
0189 <span class="comment">% out = l1homotopy(A,y,in);</span>
0190 <span class="comment">% xh = out.x_out;</span>
0191 <span class="comment">% iter_bpdn = out.iter;</span>
0192 <span class="comment">% time_bpdn = toc;</span>
0193 <span class="comment">% gamma_bpdn = out.gamma;</span>
0194 <span class="comment">% err_bpdn = out.error_table;</span>
0195 <span class="comment">%</span>
0196 <span class="comment">% W = tau;</span>
0197 <span class="comment">%</span>
0198 <span class="comment">% x_sparsa = 0;</span>
0199 <span class="comment">% tic;</span>
0200 <span class="comment">% [x_sparsa,x_debias_SpaRSA_m,obj_SpaRSA_m_cont,...</span>
0201 <span class="comment">%     times_SpaRSA_m_cont,debias_start_SpaRSA_m,mse_SpaRSA_m,taus_SpaRSA_m, numA, numAt]= ...</span>
0202 <span class="comment">%     SpaRSA_adpW(y,A,tau,...</span>
0203 <span class="comment">%     'Monotone',0,...</span>
0204 <span class="comment">%     'adp_wt',0,...</span>
0205 <span class="comment">%     'Debias',0,...</span>
0206 <span class="comment">%     'StopCriterion',2,...</span>
0207 <span class="comment">%     'ToleranceA',1e-4,...</span>
0208 <span class="comment">%     'Safeguard',1,...</span>
0209 <span class="comment">%     'MaxiterA',maxiter,...</span>
0210 <span class="comment">%     'Verbose',0,...</span>
0211 <span class="comment">%     'True_x',x,...</span>
0212 <span class="comment">%     'Continuation',1,...</span>
0213 <span class="comment">%     'Continuationsteps',-1);</span>
0214 <span class="comment">%</span>
0215 <span class="comment">% time_sparsa = toc;</span>
0216 <span class="comment">% iter_sparsa = (numA+numAt)/2;</span>
0217 <span class="comment">% error_sparsa = norm(x-x_sparsa)/norm(x);</span>
0218 
0219 
0220 <span class="keyword">for</span> sim = 1:maxsim
0221     
0222     <span class="comment">% Update the solution after updating the measurement matrix and/or the</span>
0223     <span class="comment">% sparse signal</span>
0224     x_old = x; sig_old = sig;
0225     y_old = y; A_old = A(1:M,:);
0226     
0227     <span class="comment">% Time-varying signal setup</span>
0228     dyn_ref = <span class="string">'previous'</span>;
0229     <span class="keyword">switch</span> dyn_ref
0230         <span class="keyword">case</span> <span class="string">'previous'</span>
0231             <span class="comment">% In this model, x may become dense after some time</span>
0232             
0233             <span class="comment">% Update the sparse signal.</span>
0234             rshift = rshift_h(1);
0235             x = F_h(x_old,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>, rshift);
0236             <span class="comment">% Threshold the original signal...</span>
0237             <span class="comment">% (to stop it from becoming dense) ???</span>
0238             <span class="comment">% [x_sort ind_sort] = sort(abs(x),'descend');</span>
0239             <span class="comment">% x(ind_sort(M+1:end)) = 0;</span>
0240             
0241             <span class="comment">% Update the signal estimate</span>
0242             xh_old = F_h(xh,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>,0);
0243             <span class="comment">% xh_old(abs(xh_old)&lt;max(xh_old)/1e3) = 0;</span>
0244             xh_old(abs(xh_old)&lt;tau/sqrt(log(N))) = 0;
0245             
0246         <span class="keyword">case</span> <span class="string">'initial'</span>
0247             <span class="comment">% In this model, x will probably remain sparse for all times</span>
0248             
0249             <span class="comment">% Update the sparse signal.</span>
0250             <a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a> = -sim; rshift = rshift_h(1);
0251             x = F_h(x_orig,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>, rshift);            
0252             
0253             <span class="comment">% Update the signal estimate</span>
0254             xh_old = F_h(xh,<a href="../L1_homotopy_v2.0/utils/utils_Wavelet/cshift.html" class="code" title="function y = cshift(x, t, dir)">cshift</a>-sim+1,0);
0255             <span class="comment">% xh_old(abs(xh_old)&lt;max(xh_old)/1e3) = 0;</span>
0256             xh_old(abs(xh_old)&lt;tau/sqrt(log(N))) = 0;
0257     <span class="keyword">end</span>
0258     
0259     <span class="comment">% Update weights</span>
0260     W_old = W;
0261     
0262     alpha = 1; epsilon = 1;
0263     beta = M*(norm(xh_old,2)/norm(xh_old,1))^1;
0264     W = tau/alpha./(beta*abs(xh_old)+epsilon);
0265     
0266     <span class="comment">% Update the measurements</span>
0267     in = []; in.type = mType;
0268     B = <a href="../L1_homotopy_v2.0/utils/genAmat.html" class="code" title="function A = genAmat(M,N,in);">genAmat</a>(M,N,in);
0269     e = randn(M,1)*sigma;
0270 
0271     <span class="comment">% add difference regularization</span>
0272     A = [0*A_old+1*B; lambda_diff*eye(N)];
0273     y = [A(1:M,:)*x+e; lambda_diff*xh_old];
0274     
0275     <span class="comment">% To remove diff. regularization, set lambda_diff = 0;</span>
0276     <span class="keyword">if</span> lambda_diff == 0
0277         A = A(1:M,:);
0278         y = y(1:M,:);
0279     <span class="keyword">end</span>
0280     
0281     <span class="comment">% parameter selection (you may change it at every iteration...)</span>
0282     <span class="comment">%         % tau = sigma*sqrt(log(N));</span>
0283     <span class="comment">%         tau = max(1e-3*max(abs(A'*y)),sigma*sqrt(log(N)));</span>
0284     
0285     homotopy_mode = <span class="string">'dummy'</span>;
0286     <span class="keyword">switch</span> homotopy_mode
0287         <span class="keyword">case</span> <span class="string">'dummy'</span>
0288             <span class="comment">% create a dummy variable...</span>
0289             <span class="comment">% use homotopy on the measurements...</span>
0290             <span class="comment">% in principle, we can start with any xh_old with this formulation</span>
0291             <span class="comment">% and any starting value of tau or W...</span>
0292             W_old = W;
0293             gamma = find(xh_old);
0294             M_trunc = size(A,1); <span class="comment">% M-1;</span>
0295             <span class="keyword">if</span> length(gamma) &gt; M_trunc
0296                 [xh_sort ind_sort] = sort(abs(xh_old),<span class="string">'descend'</span>);
0297                 xh_old(ind_sort(M_trunc+1:end)) = 0;
0298                 gamma = ind_sort(1:M_trunc);            
0299             <span class="keyword">end</span>            
0300             <span class="comment">% yh = A*xh_old;</span>
0301             <span class="comment">% u =  -sign(xh_old).*W_old;</span>
0302             <span class="comment">% Atdyu = A'*(yh-y)-u;</span>
0303             yh = A*xh_old;
0304             Atr = A'*(A*xh_old-y);
0305             u =  -W.*sign(xh_old)-Atr;
0306             pk_old = Atr+u;
0307         <span class="keyword">otherwise</span>
0308             didp(<span class="string">'Go back ... no escape'</span>);
0309     <span class="keyword">end</span>
0310     
0311     tic
0312     in = out;
0313     gamma_old = gamma;
0314     in.gamma = gamma_old;
0315     <span class="keyword">switch</span> delx_mode
0316         <span class="keyword">case</span> <span class="string">'mil'</span>;
0317             <span class="comment">% in.delx_mode = 'mil';</span>
0318             <span class="comment">% The following gram matrix and its inverse can be used from the</span>
0319             <span class="comment">% previous homotopy. Too lazy to include that right now...</span>
0320             <span class="comment">% wt BPDN homotopy update</span>
0321             AtAgx = A(:,gamma_old)'*A(:,gamma_old);
0322             iAtAgx = inv(AtAgx);
0323             in.iAtA = iAtAgx;
0324         <span class="keyword">case</span> {<span class="string">'qr'</span>,<span class="string">'chol'</span>};
0325             <span class="comment">% in.delx_mode = 'qr';</span>
0326             [Q R] = qr(A(:,gamma_old),0);
0327             in.Q = Q; in.R = R;
0328         <span class="keyword">case</span> <span class="string">'qrM'</span>
0329             <span class="comment">% in.delx_mode = 'qrM';</span>
0330             [Q0 R0] = qr(A(:,gamma_old));
0331             in.Q0 = Q0; in.R0 = R0;
0332     <span class="keyword">end</span>
0333     
0334     in.xh_old = xh_old;
0335     in.pk_old = pk_old;
0336     in.u = u;
0337     <span class="comment">% in.Atdyu = Atdyu;</span>
0338     in.W = W;
0339     in.W_old = W_old;
0340     in.delx_mode = delx_mode;
0341     in.debias = 0;
0342     in.verbose = 0;
0343     in.plots = 0;
0344     in.record = 0;
0345     in.err_fun = @(z) (norm(x-z)/norm(x))^2;
0346     out = <a href="l1homotopy.html" class="code" title="function out = l1homotopy(A, y, opts)">l1homotopy</a>(A,y,in);
0347     xh_dynRWT = out.x_out;
0348     gamma_dynRWT = out.gamma;
0349     iter_dynRWT = out.iter;
0350     time_dynRWT = toc;
0351     
0352     xh = xh_dynRWT;
0353     
0354     <span class="comment">%% Check the solution using BPDN directly with l1homotopy</span>
0355     <span class="comment">%     in = []; x_old = x;</span>
0356     <span class="comment">%     in.W = W;</span>
0357     <span class="comment">%     in.delx_mode = delx_mode;</span>
0358     <span class="comment">%     in.debias = 0;</span>
0359     <span class="comment">%     in.verbose = 0;</span>
0360     <span class="comment">%     in.maxiter = maxiter;</span>
0361     <span class="comment">%     in.plots = 0;</span>
0362     <span class="comment">%     in.record = 1;</span>
0363     <span class="comment">%     in.err_fun = err_fun;</span>
0364     <span class="comment">%     tic</span>
0365     <span class="comment">%     out = l1homotopy(A,y,in);</span>
0366     <span class="comment">%     xh = out.x_out;</span>
0367     <span class="comment">%     iter_bpdn = out.iter;</span>
0368     <span class="comment">%     time_bpdn = toc;</span>
0369     <span class="comment">%     gamma_bpdn = out.gamma;</span>
0370     <span class="comment">%     err_bpdn = out.error_table;</span>
0371     
0372     <span class="comment">%% SpaRSA</span>
0373     x_sparsa = xh_old; W_sparsa = W/tau;
0374     psi_function = @(x,tau) <a href="../L1_homotopy_v2.0/solvers/soft.html" class="code" title="function y = soft(x,T)">soft</a>(x,tau*W_sparsa);
0375     phi_function = @(x) sum(abs(W_sparsa.*x));
0376     tic;
0377     [x_sparsa,x_debias_SpaRSA_m,obj_SpaRSA_m_cont,<span class="keyword">...</span>
0378         times_SpaRSA_m_cont,debias_start_SpaRSA_m,mse_SpaRSA_m,taus_SpaRSA_m, numA, numAt]= <span class="keyword">...</span>
0379         <a href="../L1_homotopy_v2.0/solvers/SpaRSA_adpW.html" class="code" title="function [x,x_debias,objective,times,debias_start,mses,taus, numA, numAt]=SpaRSA_adpW(y,A,tau,varargin)">SpaRSA_adpW</a>(y,A,tau,<span class="keyword">...</span>
0380         <span class="string">'Monotone'</span>,0,<span class="keyword">...</span>
0381         <span class="string">'adp_wt'</span>,0,<span class="keyword">...</span>
0382         <span class="string">'W_new'</span>,W_sparsa,<span class="keyword">...</span>
0383         <span class="string">'Debias'</span>,0,<span class="keyword">...</span>
0384         <span class="string">'Initialization'</span>,x_sparsa,<span class="keyword">...</span>
0385         <span class="string">'StopCriterion'</span>,2,<span class="keyword">...</span>
0386         <span class="string">'ToleranceA'</span>,1e-4,<span class="keyword">...</span>
0387         <span class="string">'psi'</span>,psi_function,<span class="keyword">...</span>
0388         <span class="string">'phi'</span>,phi_function,<span class="keyword">...</span>
0389         <span class="string">'Safeguard'</span>,1,<span class="keyword">...</span>
0390         <span class="string">'MaxiterA'</span>,maxiter,<span class="keyword">...</span>
0391         <span class="string">'Verbose'</span>,0,<span class="keyword">...</span>
0392         <span class="string">'True_x'</span>,x,<span class="keyword">...</span>
0393         <span class="string">'Continuation'</span>,1,<span class="keyword">...</span>
0394         <span class="string">'Continuationsteps'</span>,-1);
0395     
0396     time_sparsa = toc;
0397     iter_sparsa = (numA+numAt)/2;    
0398     error_sparsa = norm(x-x_sparsa)/norm(x);     
0399     
0400     <span class="comment">%%</span>
0401     SIM_stack{sim} = [sim, tau, <span class="keyword">...</span>
0402         norm(x-xh_dynRWT)^2/norm(x)^2, sum(iter_dynRWT,2), sum(time_dynRWT,2),<span class="keyword">...</span>
0403         norm(x-x_sparsa)^2/norm(x)^2, sum(iter_sparsa,2), sum(time_sparsa,2)];
0404     
0405     fprintf(<span class="string">'sim %d. tau = %3.4g, (err,iter,time): dynRWT l1homotopy-%3.4g,%3.4g,%3.4g; SpaRSA-%3.4g,%3.4g,%3.4g. \n'</span>, <span class="keyword">...</span>
0406         SIM_stack{sim});
0407     
0408     <span class="comment">%% plot recovered signals</span>
0409     figure(1); 
0410     subplot(211); 
0411     plot([x xh xh_dynRWT]);
0412     subplot(212); 
0413     plot([iW_h(x) iW_h(xh)]);
0414     title(<span class="string">'Comparison betweeen the original and reconstructed signal'</span>)
0415     
0416     <span class="comment">%% Reconstructed signal</span>
0417     x_vec((sim-1)*N+1:sim*N,1) = x;
0418     xh_vec((sim-1)*N+1:sim*N,1) = xh_dynRWT; 
0419 <span class="keyword">end</span>
0420 <span class="comment">% mS =  mean(cell2mat(SIM_stack),1);</span>
0421 mS =  mean(cell2mat(SIM_stack(ceil(maxsim*0.2):maxsim,:)),1);
0422 fprintf(<span class="string">'Average results for last 80 percent iterations: maxsim %d. tau = %3.4g, (err,iter,time): dynRWT l1homotopy-%3.4g,%3.4g,%3.4g; SpaRSA-%3.4g,%3.4g,%3.4g. \n'</span>, maxsim, mS(2:end));</pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>