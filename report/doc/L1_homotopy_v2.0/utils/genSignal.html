<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of genSignal</title>
  <meta name="keywords" content="genSignal">
  <meta name="description" content="Inputs">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html L1_homotopy_v2.0 --><!-- menu.html utils -->
<h1>genSignal
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Inputs</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [x varargout] = genSignal(N,in) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">  Inputs
   N -- length of the signal
   in (input structure)
       type    -- signal type (details below)
       randgen -- randomize the signal (1) or reproduce the signal from
                   Wavelab (0)
       wType   -- type of wavelet transform

   sType: 

   T-sparse signals: randn, sign, ones, highD

   The following functions adopted from Wavelab toolbox
   Name string: 'HeaviSine', 'Blocks', 'Bumps'
            'Doppler', 'Ramp', 'Cusp', 'Sing',            
            'pcwPoly' (Piece-Wise 3rd degree polynomial)
            'pcwreg' (Piece-Regular, Piece-Wise Smooth),
            'LinChirp', 'TwoChirp', 'QuadChirp',
            'MishMash', 
            'Cusp2', 'HypChirps','LinChirps', 'Chirps',

   Sounds: 
       MATLAB options: 'chirp','gong','handel'
       Wavelab options: 'Greasy','Tweet'

   Images: 

   References
    Various articles of D.L. Donoho and I.M. Johnstone

 Originally made by David L. Donoho.
 Function has been enhanced.

  Part of Wavelab Version 850
  Built Tue Jan  3 13:20:39 EST 2006
  This is Copyrighted Material
  For Copying permissions see COPYING.m</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>	MakeSignal -- Make artificial signal</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/daub1018.html" class="code" title="function [h0, h1, g0, g1] = daub1018()">daub1018</a>	daub1018.m</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/daub79.html" class="code" title="function [h0, h1, g0, g1] = daub79()">daub79</a>	daub79.m</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>	dauborth.m</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt.html" class="code" title="">fwt</a>	fwt.m</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt2.html" class="code" title="">fwt2</a>	fwt2.m</li><li><a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/ifwt.html" class="code" title="">ifwt</a>	ifwt.m</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../L1_homotopy_v2.0/WeightedBPDN/demo_wtBPDN.html" class="code" title="">demo_wtBPDN</a>	demo_wtBPDN</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/script_simulation_adpWBPDN.html" class="code" title="">script_simulation_adpWBPDN</a>	partial script for running different solvers for adaptive reweighting</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/script_simulation_wtBPDN.html" class="code" title="">script_simulation_wtBPDN</a>	partial script for running different solvers</li><li><a href="../../L1_homotopy_v2.0/demo_BPDN.html" class="code" title="">demo_BPDN</a>	demo_BPDN</li><li><a href="../../L1_homotopy_v2.0/demo_KalmanRWT.html" class="code" title="">demo_KalmanRWT</a>	demo_KalmanRWT</li><li><a href="../../L1_homotopy_v2.0/demo_dynamicRWT.html" class="code" title="">demo_dynamicRWT</a>	demo_dynamicRWT</li><li><a href="../../L1_homotopy_v2.0/demo_dynamicSeq.html" class="code" title="">demo_dynamicSeq</a>	demo_dynamicSeq</li><li><a href="../../L1_homotopy_v2.0/demo_dynamicX.html" class="code" title="">demo_dynamicX</a>	demo_dynamicX</li><li><a href="../../L1_homotopy_v2.0/demo_posBPDN.html" class="code" title="">demo_posBPDN</a>	demo_posBPDN</li><li><a href="../../L1_homotopy_v2.0/demo_replaceDict.html" class="code" title="">demo_replaceDict</a>	demo_replaceDict</li><li><a href="../../L1_homotopy_v2.0/demo_rwtL1.html" class="code" title="">demo_rwtL1</a>	demo_rwtL1</li><li><a href="../../L1_homotopy_v2.0/demo_streaming.html" class="code" title="">demo_streaming</a>	demo_streaming</li><li><a href="../../L1_homotopy_v2.0/demo_streamingDWT.html" class="code" title="">demo_streamingDWT</a>	demo_streamingDWT</li><li><a href="../../L1_homotopy_v2.0/demo_streamingLOT.html" class="code" title="">demo_streamingLOT</a>	demo_streamingLOT</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [x varargout] = genSignal(N,in)</a>
0002 
0003 <span class="comment">%  Inputs</span>
0004 <span class="comment">%   N -- length of the signal</span>
0005 <span class="comment">%   in (input structure)</span>
0006 <span class="comment">%       type    -- signal type (details below)</span>
0007 <span class="comment">%       randgen -- randomize the signal (1) or reproduce the signal from</span>
0008 <span class="comment">%                   Wavelab (0)</span>
0009 <span class="comment">%       wType   -- type of wavelet transform</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   sType:</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   T-sparse signals: randn, sign, ones, highD</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   The following functions adopted from Wavelab toolbox</span>
0016 <span class="comment">%   Name string: 'HeaviSine', 'Blocks', 'Bumps'</span>
0017 <span class="comment">%            'Doppler', 'Ramp', 'Cusp', 'Sing',</span>
0018 <span class="comment">%            'pcwPoly' (Piece-Wise 3rd degree polynomial)</span>
0019 <span class="comment">%            'pcwreg' (Piece-Regular, Piece-Wise Smooth),</span>
0020 <span class="comment">%            'LinChirp', 'TwoChirp', 'QuadChirp',</span>
0021 <span class="comment">%            'MishMash',</span>
0022 <span class="comment">%            'Cusp2', 'HypChirps','LinChirps', 'Chirps',</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%   Sounds:</span>
0025 <span class="comment">%       MATLAB options: 'chirp','gong','handel'</span>
0026 <span class="comment">%       Wavelab options: 'Greasy','Tweet'</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   Images:</span>
0029 <span class="comment">%</span>
0030 <span class="comment">%   References</span>
0031 <span class="comment">%    Various articles of D.L. Donoho and I.M. Johnstone</span>
0032 <span class="comment">%</span>
0033 <span class="comment">% Originally made by David L. Donoho.</span>
0034 <span class="comment">% Function has been enhanced.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%  Part of Wavelab Version 850</span>
0037 <span class="comment">%  Built Tue Jan  3 13:20:39 EST 2006</span>
0038 <span class="comment">%  This is Copyrighted Material</span>
0039 <span class="comment">%  For Copying permissions see COPYING.m</span>
0040 
0041 t = (1:N)./N;
0042 <span class="keyword">if</span> isfield(in,<span class="string">'randgen'</span>); randgen = in.randgen; <span class="keyword">else</span> randgen = 0; <span class="keyword">end</span>
0043 <span class="keyword">if</span> isfield(in,<span class="string">'take_fwt'</span>); take_fwt = in.take_fwt; <span class="keyword">else</span> take_fwt = 0; <span class="keyword">end</span>
0044 
0045 wave_struct = [];
0046 sig = [];
0047 
0048 sType = in.type;
0049 
0050 <span class="keyword">switch</span> lower(sType)
0051     <span class="keyword">case</span> <span class="string">'randn'</span>
0052         T = in.T;
0053         q = randperm(N);
0054         x = zeros(N,1);
0055         x(q(1:T)) = randn(T,1);
0056         sig = x; 
0057         
0058     <span class="keyword">case</span> <span class="string">'sign'</span>
0059         T = in.T;
0060         q = randperm(N);
0061         x = zeros(N,1);
0062         x(q(1:T)) = sign(randn(T,1));
0063         sig = x; 
0064         
0065     <span class="keyword">case</span> <span class="string">'ones'</span>
0066         T = in.T;
0067         q = randperm(N);
0068         x = zeros(N,1);
0069         x(q(1:T)) = ones(T,1);
0070         sig = x; 
0071         
0072     <span class="keyword">case</span> <span class="string">'highd'</span>
0073         T = in.T;
0074         q = randperm(N);
0075         x = zeros(N,1);
0076         x(q(1:ceil(T/2))) = sign(randn(ceil(T/2),1));
0077         x(q(ceil(T/2)+1:T)) = sign(randn(T-ceil(T/2),1))./1e2;
0078         sig = x; 
0079         
0080     <span class="comment">%-----------------%</span>
0081     <span class="comment">% Wavelab signals %</span>
0082     <span class="comment">%-----------------%</span>
0083     <span class="keyword">case</span> <span class="string">'blocks'</span>
0084         <span class="keyword">if</span> randgen == 0
0085             pos = [ .1 .13 .15 .23 .25 .40 .44 .65  .76 .78 .81];
0086             hgt = [4 (-5) 3 (-4) 5 (-4.2) 2.1 4.3  (-3.1) 2.1 (-4.2)];
0087         <span class="keyword">else</span>
0088             pos = sort(rand(1,11));
0089             <span class="comment">% hgt = sign(randn(1,10)).*randint(1,10,[1 5]);</span>
0090             hgt = sign(randn(1,11)).*randi([1 5],1,11);
0091         <span class="keyword">end</span>
0092         sig = zeros(size(t));
0093         <span class="keyword">for</span> j=1:length(pos)
0094             sig = sig + (1 + sign(t-pos(j))).*(hgt(j)/2) ;
0095         <span class="keyword">end</span>
0096         sig = sig(:); 
0097     <span class="keyword">case</span> <span class="string">'bumps'</span>
0098         <span class="keyword">if</span> randgen == 0
0099             pos = [ .1 .13 .15 .23 .25 .40 .44 .65  .76 .78 .81];
0100             hgt = [ 4  5   3   4  5  4.2 2.1 4.3  3.1 5.1 4.2];
0101             wth = [.005 .005 .006 .01 .01 .03 .01 .01  .005 .008 .005];
0102         <span class="keyword">else</span>
0103             pos = sort(rand(1,11));
0104             hgt = 4+sign(randn(1,11)).*rand(1,11);
0105             wth = rand(1,11)/100;
0106         <span class="keyword">end</span>
0107         sig = zeros(size(t));
0108         <span class="keyword">for</span> j =1:length(pos)
0109             sig = sig + hgt(j)./( 1 + abs((t - pos(j))./wth(j))).^4;
0110         <span class="keyword">end</span>
0111         sig = sig(:); 
0112         
0113     <span class="keyword">case</span> <span class="string">'pcwpoly'</span> <span class="comment">% Piecewise polynomial</span>
0114         n = N;
0115         <span class="keyword">if</span> randgen == 0
0116             t = (1:fix(n/5)) ./fix(n/5);
0117             sig1=20*(t.^3+t.^2+4);
0118             sig3=40*(2.*t.^3+t) + 100;
0119             sig2=10.*t.^3 + 45;
0120             sig4=16*t.^2+8.*t+16;
0121             sig5=20*(t+4);
0122             sig6(1:fix(n/10))=ones(1,fix(n/10));
0123             sig6=sig6*20;
0124             sig(1:fix(n/5))=sig1;
0125             sig(2*fix(n/5):-1:(fix(n/5)+1))=sig2;
0126             sig((2*fix(n/5)+1):3*fix(n/5))=sig3;
0127             sig((3*fix(n/5)+1):4*fix(n/5))=sig4;
0128             sig((4*fix(n/5)+1):5*fix(n/5))=sig5(fix(n/5):-1:1);
0129             dif=n-5*fix(n/5);
0130             sig(5*fix(n/5)+1:n)=sig(dif:-1:1);
0131             <span class="comment">%sig((fix(n/20)+1):(fix(n/20)+fix(n/10)))=-ones(1,fix(n/10))*20;</span>
0132             sig((fix(n/20)+1):(fix(n/20)+fix(n/10)))=ones(1,fix(n/10))*10;
0133             sig((n-fix(n/10)+1):(n+fix(n/20)-fix(n/10)))=ones(1,fix(n/20))*150;
0134             <span class="comment">% zero-mean</span>
0135             bias=sum(sig)/n;
0136             sig=sig-bias;
0137         <span class="keyword">else</span>
0138             t = (1:fix(n/5)) ./fix(n/5);
0139             sig1=20*(t.^3+t.^2+4)*(1+(randn*.1));
0140             sig3=40*(2.*t.^3+t)*(1+(randn*.1)) + 100*(1+(randn*.05));
0141             sig2=10.*t.^3*(1+(randn*.05)) + 45*(1+(randn*.1));
0142             sig4=16*t.^2+8.*t*(1+randn*.1)+16*(1+(randn*.05));
0143             sig5=20*(t+4)*(1+(randn*.1));
0144             sig6(1:fix(n/10))=ones(1,fix(n/10))*(1+(randn*.1));
0145             sig6=sig6*20*(1+(randn*.05));
0146             sig(1:fix(n/5))=sig1;
0147             sig(2*fix(n/5):-1:(fix(n/5)+1))=sig2;
0148             sig((2*fix(n/5)+1):3*fix(n/5))=sig3;
0149             sig((3*fix(n/5)+1):4*fix(n/5))=sig4;
0150             sig((4*fix(n/5)+1):5*fix(n/5))=sig5(fix(n/5):-1:1);
0151             dif=n-5*fix(n/5);
0152             sig(5*fix(n/5)+1:n)=sig(dif:-1:1);
0153             <span class="comment">%sig((fix(n/20)+1):(fix(n/20)+fix(n/10)))=-ones(1,fix(n/10))*20;</span>
0154             sig((fix(n/20)+1):(fix(n/20)+fix(n/10)))=ones(1,fix(n/10))*10;
0155             sig((n-fix(n/10)+1):(n+fix(n/20)-fix(n/10)))=ones(1,fix(n/20))*150;
0156             <span class="comment">% zero-mean</span>
0157             bias=sum(sig)/n;
0158             sig=sig-bias;
0159         <span class="keyword">end</span>
0160         sig = sig(:);
0161          
0162     <span class="keyword">case</span> <span class="string">'heavisine'</span>
0163         <span class="keyword">if</span> randgen == 0
0164             sig = 4.*sin(4*pi.*t);
0165             sig = sig - sign(t - .3) - sign(.72 - t);
0166         <span class="keyword">else</span>
0167             sig = (1+rand*.5)*4.*sin(4*pi.*t*(1+rand*.25));
0168             sig = sig - sign(t - .3*(1+randn*.1)) - sign(.72*(1+randn*.1) - t)*(1+randn);
0169         <span class="keyword">end</span>
0170         sig = sig(:);
0171          
0172     <span class="keyword">case</span> <span class="string">'doppler'</span>
0173         <span class="keyword">if</span> randgen == 0
0174             sig = sqrt(t.*(1-t)).*sin((2*pi*1.05) ./(t+.05));
0175         <span class="keyword">else</span>
0176             sig = (1+randn*.02)*sqrt(t.*(1-t)).*sin((2*pi*1.05*(1+randn*.02)) ./(t+.05*(1+randn*.02)));
0177         <span class="keyword">end</span>
0178         sig = sig(:);
0179          
0180     <span class="keyword">case</span> <span class="string">'cusp'</span>
0181         <span class="keyword">if</span> randgen == 0
0182             sig = sqrt(abs(t - .37));
0183         <span class="keyword">else</span>
0184             sig = sqrt(abs(t - (1+0.1*rand)*.37));
0185         <span class="keyword">end</span>
0186         
0187         sig = sig(:); 
0188         
0189     <span class="keyword">case</span> <span class="string">'ramp'</span>
0190         <span class="keyword">if</span> randgen == 0
0191             sig = t - (t &gt;= .37);
0192         <span class="keyword">else</span>
0193             sig = (1+randn*.05)*t - (t &gt;= .37*(1+randn*.02));
0194         <span class="keyword">end</span>
0195         sig = sig(:);
0196               
0197     <span class="keyword">case</span> <span class="string">'pcwreg'</span> <span class="comment">% Piecewise regular</span>
0198         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'Piece-Regular'</span>,N);
0199         
0200         sig = sig(:);    
0201         
0202     <span class="keyword">case</span> <span class="string">'cusp2'</span>
0203         n = N/8;
0204         i1 = (1:n)./n;
0205         x = (1-sqrt(i1)) + i1/2 -.5;
0206         sig = zeros(1,N);
0207         sig(N-1.5*n+1:N-.5*n) = x;
0208         sig(N-2.5*n+2:N-1.5*n+1) = fliplr(x);
0209         sig(3*n+1:3*n + n) = .5*ones(1,n);
0210         sig = sig(:); 
0211         
0212     <span class="keyword">case</span> <span class="string">'sing'</span>
0213         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'Sing'</span>,N); 
0214 
0215         sig = sig(:);        
0216         
0217         
0218     <span class="comment">%--------------%</span>
0219     <span class="comment">% Kalman model %</span>
0220     <span class="comment">%--------------%</span>
0221     <span class="keyword">case</span> lower(<span class="string">'kalman-heavisine'</span>)        
0222         Np = in.Np;
0223         t = (1:Np)./Np;
0224         N = Np*ceil(N/Np);
0225         sig = zeros(N,1);
0226  
0227         randgen = 0;
0228         <span class="keyword">for</span> p = 1:ceil(N/Np);
0229             sigt = zeros(Np,1);
0230             <span class="keyword">if</span> randgen == 0
0231                 sigt = 4.*sin(4*pi.*t);
0232                 sigt = sigt - sign(t - .3) - sign(.72 - t);
0233             <span class="keyword">else</span>
0234                 sigt = (1+rand*.01)*4.*sin(4*pi.*t*(1+rand*.025));
0235                 sigt = sigt - sign(t - .3*(1+randn*.01)) - sign(.72*(1+randn*.01) - t)*(1+randn*.02);
0236             <span class="keyword">end</span>
0237             randgen = 1;
0238             sig((p-1)*Np+1:p*Np) = sigt;
0239         <span class="keyword">end</span>
0240         sig = sig(:);
0241     <span class="keyword">case</span> <span class="string">'kalman-pcwpoly'</span> <span class="comment">% Piecewise polynomial</span>
0242         Np = in.Np;
0243         n = Np;
0244         N = Np*ceil(N/Np);
0245         sig = zeros(N,1);
0246  
0247         randgen = 0;
0248         <span class="keyword">for</span> p = 1:ceil(N/Np);
0249             sigt = zeros(Np,1);
0250             
0251             <span class="keyword">if</span> randgen == 0                
0252                 t = (1:fix(n/5)) ./fix(n/5);
0253                 sig1=20*(t.^3+t.^2+4);
0254                 sig3=40*(2.*t.^3+t) + 100;
0255                 sig2=10.*t.^3 + 45;
0256                 sig4=16*t.^2+8.*t+16;
0257                 sig5=20*(t+4);
0258                 sig6(1:fix(n/10))=ones(1,fix(n/10));
0259                 sig6=sig6*20;
0260                 sigt(1:fix(n/5))=sig1;
0261                 sigt(2*fix(n/5):-1:(fix(n/5)+1))=sig2;
0262                 sigt((2*fix(n/5)+1):3*fix(n/5))=sig3;
0263                 sigt((3*fix(n/5)+1):4*fix(n/5))=sig4;
0264                 sigt((4*fix(n/5)+1):5*fix(n/5))=sig5(fix(n/5):-1:1);
0265                 dif=n-5*fix(n/5);
0266                 sigt(5*fix(n/5)+1:n)=sigt(dif:-1:1);
0267                 <span class="comment">%sigt((fix(n/20)+1):(fix(n/20)+fix(n/10)))=-ones(1,fix(n/10))*20;</span>
0268                 sigt((fix(n/20)+1):(fix(n/20)+fix(n/10)))=ones(1,fix(n/10))*10;
0269                 sigt((n-fix(n/10)+1):(n+fix(n/20)-fix(n/10)))=ones(1,fix(n/20))*150;
0270                 <span class="comment">% zero-mean</span>
0271                 bias=sum(sigt)/n;
0272                 sigt=sigt-bias;
0273             <span class="keyword">else</span>                
0274                 t = (1:fix(n/5)) ./fix(n/5);
0275                 sig1=20*(t.^3+t.^2+4)*(1+(randn*.1));
0276                 sig3=40*(2.*t.^3+t)*(1+(randn*.1)) + 100*(1+(randn*.05));
0277                 sig2=10.*t.^3*(1+(randn*.05)) + 45*(1+(randn*.1));
0278                 sig4=16*t.^2+8.*t*(1+randn*.1)+16*(1+(randn*.05));
0279                 sig5=20*(t+4)*(1+(randn*.1));
0280                 sig6(1:fix(n/10))=ones(1,fix(n/10))*(1+(randn*.1));
0281                 sig6=sig6*20*(1+(randn*.05));
0282                 sigt(1:fix(n/5))=sig1;
0283                 sigt(2*fix(n/5):-1:(fix(n/5)+1))=sig2;
0284                 sigt((2*fix(n/5)+1):3*fix(n/5))=sig3;
0285                 sigt((3*fix(n/5)+1):4*fix(n/5))=sig4;
0286                 sigt((4*fix(n/5)+1):5*fix(n/5))=sig5(fix(n/5):-1:1);
0287                 dif=n-5*fix(n/5);
0288                 sigt(5*fix(n/5)+1:n)=sigt(dif:-1:1);
0289                 <span class="comment">%sigt((fix(n/20)+1):(fix(n/20)+fix(n/10)))=-ones(1,fix(n/10))*20;</span>
0290                 sigt((fix(n/20)+1):(fix(n/20)+fix(n/10)))=ones(1,fix(n/10))*10;
0291                 sigt((n-fix(n/10)+1):(n+fix(n/20)-fix(n/10)))=ones(1,fix(n/20))*150;
0292                 <span class="comment">% zero-mean</span>
0293                 bias=sum(sigt)/n;
0294                 sigt=sigt-bias;
0295             <span class="keyword">end</span>
0296             randgen = 0;
0297             sig((p-1)*Np+1:p*Np) = sigt;
0298         <span class="keyword">end</span>
0299         sig = sig(:);
0300         
0301     <span class="comment">%--------%</span>
0302     <span class="comment">% images %</span>
0303     <span class="comment">%--------%</span>
0304     <span class="keyword">case</span> lower(<span class="string">'image-barbara'</span>);
0305         I = double(imread(<span class="string">'barbara.ras'</span>));
0306         [ROW COL] = size(I);
0307         I = imresize(I, [ROW N]);        
0308         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0309         vec = @(z) z(:);
0310         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0311         sig = vec(I'); 
0312     <span class="keyword">case</span> lower(<span class="string">'image-baboon'</span>);
0313         I = double(imread(<span class="string">'baboon.ras'</span>));
0314         [ROW COL] = size(I);
0315         I = imresize(I, [ROW N]);        
0316         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0317         vec = @(z) z(:);
0318         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0319         sig = vec(I');     
0320     <span class="keyword">case</span> lower(<span class="string">'image-cameraman'</span>);
0321         I = double(imread(<span class="string">'cameraman.tif'</span>));
0322         [ROW COL] = size(I);
0323         I = imresize(I, [ROW N]);        
0324         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0325         vec = @(z) z(:);
0326         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0327         sig = vec(I');
0328     <span class="keyword">case</span> lower(<span class="string">'image-house'</span>);
0329         I = double(rgb2gray(imread(<span class="string">'house.tif'</span>)));
0330         [ROW COL] = size(I);
0331         I = imresize(I, [ROW N/2]);        
0332         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0333         vec = @(z) z(:);
0334         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0335         I = [I(1:2:<span class="keyword">end</span>,:) fliplr(I(2:2:<span class="keyword">end</span>,:))];
0336         figure(123);
0337         subplot(121); imagesc(I');
0338         subplot(122); imagesc(diff(I',[],2));
0339 
0340         sig = vec(I');
0341     <span class="keyword">case</span> lower(<span class="string">'image-boats'</span>);
0342         load(<span class="string">'boats'</span>);
0343         I = double(sig);
0344         [ROW COL] = size(I);
0345         I = imresize(I, [ROW N/2]);        
0346         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0347         vec = @(z) z(:);
0348         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0349         <span class="comment">% I = [I(1:2:end,:) fliplr(I(2:2:end,:))];</span>
0350         figure(123); 
0351         subplot(121); imagesc(I');
0352         subplot(122); imagesc(diff(I',[],2));
0353         
0354         sig = vec(I');
0355     <span class="keyword">case</span> lower(<span class="string">'image-saturn'</span>)
0356         I = double(rgb2gray(imread(<span class="string">'saturn4.jpg'</span>)));
0357         [ROW COL] = size(I);
0358         I = imresize(I, [ROW N/2]);        
0359         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0360         vec = @(z) z(:);
0361         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0362         I = [I(1:2:<span class="keyword">end</span>,:) fliplr(I(2:2:<span class="keyword">end</span>,:))];
0363 
0364         figure(123); 
0365         subplot(121); imagesc(I');
0366         subplot(122); imagesc(diff(I',[],2));
0367 
0368         sig = vec(I');     
0369     <span class="keyword">case</span> lower(<span class="string">'image-chirp'</span>)
0370         I = double(rgb2gray(imread(<span class="string">'pattern.jpg'</span>)));                 
0371         [ROW COL] = size(I);
0372         I = imresize(I, [ROW N]);        
0373         <span class="comment">% I = I-repmat(mean(I,2),1,N);</span>
0374         vec = @(z) z(:);
0375         <span class="comment">% sig = double(vec(I(zigzag_order(ROW,COL))));</span>
0376         sig = vec(I');
0377         <span class="comment">% I = double(rgb2gray(imread('ohare1.jpg'))); I = I-mean(I(:)); [M N]=size(I);</span>
0378         <span class="comment">% for ii=1:2:M-1; figure(1); imagesc(I); figure(2); plot(I(ii:ii+1,:)'); figure(3); plot(fftshift(abs(fft(I(ii:ii+1,:)')))); title(ii); drawnow; pause(1/10); end</span>
0379         
0380     <span class="comment">%--------%</span>
0381     <span class="comment">% Chirps %</span>
0382     <span class="comment">%--------%</span>
0383     <span class="keyword">case</span> lower(<span class="string">'LinChirp'</span>)
0384         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'LinChirp'</span>,N);
0385         sig = sig(:);        
0386     
0387     <span class="keyword">case</span>  lower(<span class="string">'TwoChirp'</span>)
0388         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'TwoChirp'</span>,N);
0389         sig = sig(:);
0390         
0391     <span class="keyword">case</span> lower(<span class="string">'QuadChirp'</span>)
0392         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'QuadChirp'</span>,N);
0393         sig = sig(:);
0394         
0395     <span class="keyword">case</span> lower(<span class="string">'MishMash'</span>)
0396         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'MishMash'</span>,N);
0397         sig = sig(:);
0398         
0399     <span class="keyword">case</span> lower(<span class="string">'LinChirps'</span>)
0400         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'LinChirps'</span>,N);
0401         sig = sig(:); 
0402         
0403     <span class="keyword">case</span> lower(<span class="string">'Chirps'</span>)
0404         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'Chirps'</span>,N);
0405         sig = sig(:);       
0406      
0407     <span class="keyword">case</span> lower(<span class="string">'HypChirps'</span>)
0408         <span class="comment">% strcmp(Name,'HypChirps'), % Hyperbolic Chirps of Mallat's book</span>
0409         N = round(N*1.75);
0410         sig = <a href="MakeSignal.html" class="code" title="function sig = MakeSignal(Name,n)">MakeSignal</a>(<span class="string">'HypChirps'</span>,N);
0411         sig = sig(N/10+1:round(.65*N)+N/10);      
0412         sig = sig(1:2^(floor(log2(length(sig)))));
0413         sig = sig(:);
0414 
0415     <span class="keyword">case</span> lower(<span class="string">'chirp-MATLAB'</span>)<span class="comment">% % Chirp model 2</span>
0416         <span class="comment">% Fs = 200;</span>
0417         <span class="comment">% t = -1:1/Fs:1-1/Fs;</span>
0418         <span class="comment">% fo = Fs/3; f1 = 2*Fs/3;</span>
0419         <span class="comment">% X = chirp(t,fo,1,f1,'q',[],'convex')';</span>
0420         <span class="comment">% % X = chirp(t,fo,1,f1,'li')';</span>
0421         <span class="comment">% figure(501); spectrogram(X,hanning(256),128,256,Fs,'yaxis'); shg</span>
0422         <span class="comment">% len_stream = length(t);</span>
0423         <span class="comment">% K = 0;</span>
0424 
0425         
0426     <span class="comment">%--------%</span>
0427     <span class="comment">% Sounds %</span>
0428     <span class="comment">%--------%</span>
0429     <span class="keyword">case</span> {<span class="string">'chirp'</span>,<span class="string">'gong'</span>,<span class="string">'handel'</span>}
0430         eval(sprintf(<span class="string">'load %s.mat'</span>,sType));
0431         sig = y; <span class="comment">% interp1(1:length(y),y,1:1/2:length(y))';</span>
0432         x = sig(:);
0433     <span class="keyword">case</span> {<span class="string">'greasy'</span>,<span class="string">'tweet'</span>}
0434         eval(<span class="string">'sig = ReadSignal(sType);'</span>);
0435         x = sig; 
0436     <span class="comment">%--------%</span>
0437     <span class="comment">% Images %</span>
0438     <span class="comment">%--------%</span>
0439     <span class="keyword">case</span> {<span class="string">'cameraman'</span>,<span class="string">'barbara'</span>,<span class="string">'lena'</span>,<span class="string">'peppers'</span>,<span class="string">'airplane'</span>,<span class="string">'baboon'</span>,<span class="string">'sailboat'</span>,<span class="string">'tiffany'</span>,<span class="string">'boats'</span>,<span class="string">'shapes'</span>,<span class="string">'pirate'</span>,<span class="string">'house'</span>}
0440         n = sqrt(N);
0441         <span class="keyword">switch</span> sType
0442             <span class="keyword">case</span> {<span class="string">'shapes'</span>,<span class="string">'boats'</span>}
0443                 load(sType);
0444             <span class="keyword">case</span> {<span class="string">'pirate'</span>,<span class="string">'cameraman'</span>}
0445                 sig = double(imread(sType,<span class="string">'tif'</span>));
0446             <span class="keyword">otherwise</span>
0447                 sig = double(imread(sType,<span class="string">'ras'</span>));
0448         <span class="keyword">end</span>
0449         sig = imresize(sig,n/size(sig,1));
0450         [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/daub79.html" class="code" title="function [h0, h1, g0, g1] = daub79()">daub79</a>; sym = 1; wType = <span class="string">'daub79'</span>;
0451         <span class="comment">% [h0 h1 g0 g1] = dauborth(4); sym = 0; wType = 'daub4';</span>
0452         <span class="comment">% [h0 h1 g0 g1] = dauborth(8); sym = 0; wType = 'daub8';</span>
0453         
0454         fprintf(<span class="string">'Image: %s, size: %dx%d, wavelet: %s \n'</span>,sType, n,n, wType);
0455         J = floor(log2(n)-4);
0456         x = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt2.html" class="code" title="">fwt2</a>(sig,h0,h1,J,sym);
0457         x = x(:);
0458         sig = x;
0459         N = length(x);
0460         
0461         wave_struct = {};
0462         wave_struct.wType = wType;
0463         wave_struct.J = J;
0464         wave_struct.FilterBank = [h0; h1; g0; g1];
0465         wave_struct.sym = sym;
0466         
0467         take_fwt = 0;
0468          
0469     <span class="keyword">case</span> <span class="string">'phantom'</span>
0470         n = sqrt(N);
0471         sig = phantom(<span class="string">'Modified Shepp-Logan'</span>,n);
0472         [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>(2); sym = 0; wType = <span class="string">'haar'</span>;
0473         
0474         fprintf(<span class="string">'Image: %s, size: %dx%d, wavelet: %s \n'</span>,sType, n,n, wType);
0475         J = floor(log2(n)-3);
0476         x = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt2.html" class="code" title="">fwt2</a>(sig,h0,h1,J,sym);
0477         x = x(:);
0478         N = length(x);
0479         
0480         wave_struct = {};
0481         wave_struct.wType = wType;
0482         wave_struct.J = J;
0483         wave_struct.FilterBank = [h0; h1; g0; g1];
0484         wave_struct.sym = sym;
0485          
0486         take_fwt = 0;
0487     <span class="keyword">otherwise</span>
0488         disp(<span class="string">'NAO'</span>);
0489         
0490 <span class="keyword">end</span>
0491 
0492 <span class="keyword">if</span> take_fwt == 1
0493     <span class="keyword">if</span> isfield(in,<span class="string">'wType'</span>)
0494         wType = in.wType;
0495     <span class="keyword">else</span>
0496         wType = <span class="string">'daub4'</span>;
0497     <span class="keyword">end</span>
0498     <span class="keyword">if</span> exist(<span class="string">'wType'</span>,<span class="string">'var'</span>)
0499         <span class="keyword">switch</span> lower(wType)
0500             <span class="keyword">case</span> <span class="string">'haar'</span>
0501                 [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>(2); sym = 0; wType = <span class="string">'haar'</span>;
0502             <span class="keyword">case</span> <span class="string">'daub4'</span>
0503                 [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>(4); sym = 0; wType = <span class="string">'daub4'</span>;
0504             <span class="keyword">case</span> <span class="string">'daub8'</span>
0505                 [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>(8); sym = 0; wType = <span class="string">'daub8'</span>;
0506             <span class="keyword">case</span> <span class="string">'daub79'</span>
0507                 [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/daub79.html" class="code" title="function [h0, h1, g0, g1] = daub79()">daub79</a>; sym = 1; wType = <span class="string">'daub79'</span>;
0508             <span class="keyword">case</span> <span class="string">'daub1018'</span>
0509                 [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/daub1018.html" class="code" title="function [h0, h1, g0, g1] = daub1018()">daub1018</a>; sym = 2; wType = <span class="string">'daub1018'</span>;
0510             <span class="keyword">otherwise</span>
0511                 disp(<span class="string">'NAO'</span>);
0512         <span class="keyword">end</span>
0513     <span class="keyword">else</span>
0514         [h0 h1 g0 g1] = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/dauborth.html" class="code" title="function [h0,h1,g0,g1] = dauborth(M)">dauborth</a>(4); sym = 0; wType = <span class="string">'daub4'</span>;
0515     <span class="keyword">end</span>
0516     <span class="keyword">if</span> isfield(in,<span class="string">'J'</span>);
0517         J = in.J;
0518     <span class="keyword">else</span> 
0519         J = floor(log2(N));
0520     <span class="keyword">end</span>
0521     x = <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt.html" class="code" title="">fwt</a>(sig,h0,h1,J,sym);
0522     W_h = @(x) <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/fwt.html" class="code" title="">fwt</a>(x,h0,h1,J,sym);
0523     iW_h = @(x) <a href="../../L1_homotopy_v2.0/utils/utils_Wavelet/ifwt.html" class="code" title="">ifwt</a>(x,g0,g1,J,sym);
0524     
0525     wave_struct = {};
0526     wave_struct.W_h = W_h;
0527     wave_struct.iW_h = iW_h;
0528 <span class="keyword">else</span>
0529     x = sig;
0530 <span class="keyword">end</span>
0531 
0532 <span class="keyword">if</span> isfield(in,<span class="string">'plot'</span>)
0533     <span class="keyword">if</span> in.plot
0534         figure(1);
0535         subplot(211); set(gca,<span class="string">'FontSize'</span>,16);
0536         plot(sig,<span class="string">'LineWidth'</span>,2); set(gca,<span class="string">'XLim'</span>,[1 N]);
0537         axis tight; YLim = get(gca,<span class="string">'YLim'</span>);
0538         dY = YLim(2)-YLim(1);
0539         YLim = [YLim(1)-dY/10 YLim(2)+dY/10];
0540         set(gca,<span class="string">'YLim'</span>,YLim);
0541         set(gca,<span class="string">'XtickLabel'</span>,<span class="string">''</span>)
0542         ylabel(sType);
0543         subplot(212); set(gca,<span class="string">'FontSize'</span>,16);
0544         plot(x,<span class="string">'LineWidth'</span>,2); set(gca,<span class="string">'XLim'</span>,[1 N]);
0545         axis tight; YLim = get(gca,<span class="string">'YLim'</span>);
0546         dY = YLim(2)-YLim(1);
0547         YLim = [YLim(1)-dY/10 YLim(2)+dY/10];
0548         set(gca,<span class="string">'YLim'</span>,YLim);
0549         set(gca,<span class="string">'XtickLabel'</span>,<span class="string">''</span>)
0550         ylabel(wType);
0551     <span class="keyword">end</span>
0552 <span class="keyword">end</span>
0553 
0554 nout = max(nargout,1) - 1;
0555 <span class="keyword">if</span> nout &gt; 0
0556     varargout{1} = sig;
0557 <span class="keyword">end</span>
0558 <span class="keyword">if</span> nout &gt; 1
0559     varargout{2} = wave_struct;
0560 <span class="keyword">end</span>
0561</pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>