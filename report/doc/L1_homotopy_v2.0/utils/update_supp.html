<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of update_supp</title>
  <meta name="keywords" content="update_supp">
  <meta name="description" content="script to update support">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html L1_homotopy_v2.0 --><!-- menu.html utils -->
<h1>update_supp
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>script to update support</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> script to update support</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../L1_homotopy_v2.0/Pursuits_Homotopy/BPDN_homotopy_function.html" class="code" title="function out = BPDN_homotopy_function(A, y, in)">BPDN_homotopy_function</a>	BPDN_homotopy_function.m</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_Update_function_v1.html" class="code" title="function out = wtBPDN_Update_function_v1(A, y, in);">wtBPDN_Update_function_v1</a>	Iterative reweighting updates for BPDN</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_Update_function_v2.html" class="code" title="function out = wtBPDN_Update_function_v2(A, y, in);">wtBPDN_Update_function_v2</a>	BPDN_homotopy_ReWeighted.m</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_adaptive_function.html" class="code" title="function out = wtBPDN_adaptive_function(A, y, in)">wtBPDN_adaptive_function</a>	wtBPDN_adaptive_function</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_homotopy_function.html" class="code" title="function out = wtBPDN_homotopy_function(A, y, in)">wtBPDN_homotopy_function</a>	wtBPDN_homotopy_function</li><li><a href="../../L1_homotopy_v2.0/l1homotopy.html" class="code" title="function out = l1homotopy(A, y, opts)">l1homotopy</a>	l1homotopy.m</li><li><a href="../../L1_homotopy_v2.0/l1homotopy_v1.html" class="code" title="function out = l1homotopy_v1(A, y, opts)">l1homotopy_v1</a>	l1homotopy_v1.m</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% script to update support</span>
0002 <span class="keyword">if</span> length(gamma_xh)==M &amp;&amp; flag == 1
0003     <span class="comment">% swap an element...</span>
0004     Ag = A(:,gamma_xh)'*A(:,idelta);
0005     xg = xk_1(gamma_xh);
0006     zx = -sign(pk(idelta)+delta*dk(idelta));
0007     
0008     <span class="comment">% delx = -AtAgx\(Ag*zx);</span>
0009     <span class="comment">% delx = -AtAgx\(Ag*zx); % WHY?????????</span>
0010     <span class="keyword">switch</span> delx_mode
0011         <span class="keyword">case</span> <span class="string">'mil'</span>
0012             delx = -iAtA*(Ag*zx);
0013         <span class="keyword">case</span> <span class="string">'qr'</span>
0014             delx = -R\(R'\(Ag*zx));
0015     <span class="keyword">end</span>
0016     
0017     delta_out = -xg./delx;
0018     idelta_out = find(delta_out&gt;0);
0019     <span class="keyword">if</span> ~isempty(idelta_out)
0020         [delta_t idelta_tmp] = min(delta_out(idelta_out));
0021         idelta_t = gamma_xh(idelta_out(idelta_tmp));
0022         
0023         x_old = xk_1;
0024         xk_1(gamma_xh) = xg+delta_t*delx;
0025         xk_1(idelta) = delta_t*zx;
0026         xk_1(idelta_t) = 0;
0027         
0028         <span class="comment">% Remember remember the Simplex pivoting</span>
0029         <span class="comment">% disp(sprintf(['iter = %d, delta = %3.4g, delta_t = %3.4g, idelta = %d, idelta_t = %d, flag = %d'], iter, delta, delta_t, idelta, idelta_t, -2));</span>
0030         
0031         outx_index = find(gamma_xh==idelta_t);
0032         gamma_xh = [gamma_xh(1:outx_index-1); gamma_xh(outx_index+1:end); gamma_xh(outx_index)];
0033         g_old = gamma_xh;
0034         
0035         gamma_xh(end) = idelta;
0036         
0037         <span class="comment">% itr_history = [itr_history; idelta_t delta_t 2];</span>
0038         
0039         new_order = [1:outx_index-1, outx_index+1:length(g_old), outx_index]';
0040         
0041         in_delx.new_order = new_order;
0042         in_delx.out_i = outx_index;
0043         in_delx.add_rem = 2;
0044         in_delx.Gamma = g_old;
0045         in_delx.new_x = idelta;
0046         idelta = idelta_t; <span class="comment">% To set its constraints.</span>
0047     <span class="keyword">else</span>
0048         disp(<span class="string">'Fatal error'</span>);
0049         <span class="keyword">break</span>;
0050     <span class="keyword">end</span>
0051 <span class="keyword">else</span>
0052     <span class="keyword">if</span> flag == 1
0053         <span class="comment">% add an element</span>
0054         g_old = gamma_xh;
0055         gamma_xh = [gamma_xh; idelta];
0056         xk_1(idelta) = 0;
0057         
0058         gamma_xc(gamma_xc==idelta) = [];
0059         
0060         in_delx.new_x = idelta;
0061         in_delx.add_rem = 1;
0062         in_delx.Gamma = g_old;
0063     <span class="keyword">else</span>
0064         <span class="comment">% remove an element</span>
0065         outx_index = find(gamma_xh==idelta);
0066         len_gamma = length(gamma_xh);
0067         <span class="keyword">if</span> len_gamma == 1
0068             <span class="keyword">break</span>;
0069         <span class="keyword">end</span>
0070         gamma_xh = [gamma_xh(1:outx_index-1); gamma_xh(outx_index+1:end); gamma_xh(outx_index)];
0071         g_old = gamma_xh;
0072         
0073         gamma_xh = gamma_xh(1:len_gamma-1);
0074         
0075         gamma_xc = [gamma_xc; idelta];
0076         
0077         xk_1(idelta) = 0;
0078         
0079         new_order = [1:outx_index-1, outx_index+1:length(g_old), outx_index]';
0080         
0081         in_delx.new_order = new_order;
0082         in_delx.out_i = outx_index;
0083         in_delx.add_rem = 0;
0084         in_delx.Gamma = g_old;
0085     <span class="keyword">end</span>
0086 <span class="keyword">end</span>
0087 
0088 <span class="comment">% temp_gamma = zeros(N,1);</span>
0089 <span class="comment">% temp_gamma(gamma_xh) = gamma_xh;</span>
0090 <span class="comment">% gamma_xc = find([1:N]' ~= temp_gamma);</span></pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>