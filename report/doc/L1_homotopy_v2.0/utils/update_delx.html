<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of update_delx</title>
  <meta name="keywords" content="update_delx">
  <meta name="description" content="script to ubpdate delx">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html L1_homotopy_v2.0 --><!-- menu.html utils -->
<h1>update_delx
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>script to ubpdate delx</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> script to ubpdate delx</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>	This function solves a system of the form A^TA delx = z.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../L1_homotopy_v2.0/Pursuits_Homotopy/BPDN_homotopy_function.html" class="code" title="function out = BPDN_homotopy_function(A, y, in)">BPDN_homotopy_function</a>	BPDN_homotopy_function.m</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_Update_function_v1.html" class="code" title="function out = wtBPDN_Update_function_v1(A, y, in);">wtBPDN_Update_function_v1</a>	Iterative reweighting updates for BPDN</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_Update_function_v2.html" class="code" title="function out = wtBPDN_Update_function_v2(A, y, in);">wtBPDN_Update_function_v2</a>	BPDN_homotopy_ReWeighted.m</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_adaptive_function.html" class="code" title="function out = wtBPDN_adaptive_function(A, y, in)">wtBPDN_adaptive_function</a>	wtBPDN_adaptive_function</li><li><a href="../../L1_homotopy_v2.0/WeightedBPDN/src/wtBPDN_homotopy_function.html" class="code" title="function out = wtBPDN_homotopy_function(A, y, in)">wtBPDN_homotopy_function</a>	wtBPDN_homotopy_function</li><li><a href="../../L1_homotopy_v2.0/l1homotopy.html" class="code" title="function out = l1homotopy(A, y, opts)">l1homotopy</a>	l1homotopy.m</li><li><a href="../../L1_homotopy_v2.0/l1homotopy_v1.html" class="code" title="function out = l1homotopy_v1(A, y, opts)">l1homotopy_v1</a>	l1homotopy_v1.m</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% script to ubpdate delx</span>
0002 <span class="keyword">switch</span> update_mode
0003     <span class="keyword">case</span> <span class="string">'init0'</span>
0004         <span class="keyword">switch</span> delx_mode
0005             <span class="keyword">case</span> <span class="string">'mil'</span>
0006                 iAtA = pinv(A(:,gamma_xh)'*A(:,gamma_xh));
0007                 delx = iAtA*rhs(gamma_xh);
0008             <span class="keyword">case</span> {<span class="string">'qr'</span>,<span class="string">'chol'</span>}
0009                 [Q R] = qr(A(:,gamma_xh),0);
0010                 delx = R\(R'\rhs(gamma_xh));
0011             <span class="keyword">case</span> <span class="string">'qrM'</span>
0012                 [Q0 R0] = qr(A(:,gamma_xh));
0013                 delx = R0\(R0'\rhs(gamma_xh));            
0014         <span class="keyword">end</span>
0015     <span class="keyword">case</span> <span class="string">'init1'</span>
0016         <span class="keyword">switch</span> delx_mode
0017             <span class="keyword">case</span> <span class="string">'mil'</span>
0018                 <span class="comment">% AtAgx = in.AtA;</span>
0019                 iAtA = opts.iAtA;
0020                 delx = iAtA*rhs(gamma_xh);
0021                 <span class="comment">% iAtAgx = opts.iAtAgx;</span>
0022                 <span class="comment">% delx_update = iAtAgx*(ds(gamma_xh)-d(gamma_xh));</span>
0023             <span class="keyword">case</span> <span class="string">'qr'</span>
0024                 Q = opts.Q;
0025                 R = opts.R;
0026                 delx = R\(R'\rhs(gamma_xh));
0027                 <span class="comment">% delx_update = R\(R'\(ds(gamma_xh)-d(gamma_xh)));</span>
0028             <span class="keyword">case</span> <span class="string">'qrM'</span>
0029                 Q0 = opts.Q0;
0030                 R0 = opts.R0;
0031                 delx = R0\(R0'\rhs(gamma_xh));            
0032                 <span class="comment">% delx_update = R0\(R0'\(ds(gamma_xh)-d(gamma_xh)));</span>
0033             <span class="keyword">case</span> <span class="string">'chol'</span>
0034                 R = opts.R;
0035                 delx = R\(R'\rhs(gamma_xh));
0036         <span class="keyword">end</span>
0037         <span class="comment">% delx = opts.delx;</span>
0038     <span class="keyword">case</span> <span class="string">'update'</span>
0039         <span class="comment">% script to update delx</span>
0040         in_delx.rhs = rhs;
0041         in_delx.itr = iter;
0042         in_delx.M = M;
0043         <span class="keyword">switch</span> delx_mode
0044             <span class="keyword">case</span> <span class="string">'mil'</span>
0045                 in_delx.iAtA = iAtA;
0046                 in_delx.delx = delx;
0047                 in_delx.type = delx_mode;
0048                 out = <a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>(in_delx,A);
0049                 delx = out.delx;
0050                 iAtA = out.iAtA;
0051             <span class="keyword">case</span> <span class="string">'qr'</span>
0052                 in_delx.R = R;
0053                 in_delx.Q = Q;
0054                 in_delx.delx = delx;
0055                 in_delx.type = delx_mode;
0056                 in_delx.nre = 2;
0057                 out = <a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>(in_delx,A);
0058                 R = out.R;
0059                 Q = out.Q;
0060                 delx = out.delx;
0061             <span class="keyword">case</span> <span class="string">'qrM'</span>
0062                 in_delx.R0 = R0;
0063                 in_delx.Q0 = Q0;
0064                 in_delx.delx = gamma_xh;
0065                 in_delx.type = <span class="string">'qrM'</span>;
0066                 out = <a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>(in_delx,A);
0067                 R0 = out.R0;
0068                 Q0 = out.Q0;
0069                 delx = out.delx;
0070             <span class="keyword">case</span> <span class="string">'chol'</span>
0071                 in_delx.R = R;
0072                 in_delx.delx = delx;
0073                 in_delx.type = delx_mode;
0074                 out = <a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>(in_delx,A);
0075                 R = out.R;
0076                 delx = out.delx;
0077             <span class="keyword">case</span> <span class="string">'cg'</span>
0078                 <span class="comment">% NOT TESTED ...</span>
0079                 <span class="comment">% delx_orig = (A(:,gamma_xh)'*A(:,gamma_xh))\(ds(gamma_xh)-d(gamma_xh));</span>
0080                 in_delx.x0 = xk_1;
0081                 in_delx.Gamma = gamma_xh;
0082                 in_delx.delx = [];
0083                 in_delx.W = in.W_new(gamma_xh);
0084                 in_delx.type = <span class="string">'cg'</span>;
0085                 delta = theta;
0086                 in_delx.rhs = cg_rhs-(epsilon+delta)*d-(1-epsilon-delta)*ds+tau*sign(pk_old);
0087                 out = <a href="compute_delx.html" class="code" title="function out = compute_delx(in,A)">compute_delx</a>(in_delx,A);
0088                 delx = (out.delx-xk_1(gamma_xh))/delta;
0089                 stp = 1;
0090         <span class="keyword">end</span>
0091     <span class="keyword">case</span> <span class="string">'recompute'</span>
0092         <span class="keyword">switch</span> delx_mode
0093             <span class="keyword">case</span> <span class="string">'mil'</span>
0094                 delx = iAtA*rhs(gamma_xh);
0095                 <span class="comment">% iAtAgx = in.iAtAgx;</span>
0096                 <span class="comment">% delx_update = iAtAgx*(ds(gamma_xh)-d(gamma_xh));</span>
0097             <span class="keyword">case</span> {<span class="string">'qr'</span>,<span class="string">'chol'</span>}
0098                 delx = R\(R'\rhs(gamma_xh));
0099             <span class="keyword">case</span> <span class="string">'qrM'</span>
0100                 delx = R0\(R0'\rhs(gamma_xh));
0101         <span class="keyword">end</span>
0102 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 09-Jun-2013 02:08:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>